# Proposal: Add Chat Message Styling Sub-Models

## Summary

设计聊天面板消息样式子系统，为用户消息和AI消息创建不同的子模型，通过边框颜色、对齐方式和角色标签来区分消息类型。

## Motivation

当前聊天面板只显示占位符内容，没有实际的消息渲染逻辑。需要实现一个清晰的视觉区分系统，让用户能够：
1. 快速区分用户消息和AI消息
2. 通过视觉层次提升可读性
3. 保持与现有UI风格的一致性

## Proposed Solution

### 1. 消息子模型设计

创建 `ChatMessage` 子模型，根据消息角色（RoleUser/RoleAssistant）应用不同的样式：
- **用户消息**：绿色边框 + 右对齐 + "You:" 标签
- **AI消息**：蓝色边框 + 左对齐 + "AI:" 标签

### 2. 视觉设计规范

```
┌─────────────────────────────────────────┐
│      Sessions - New Chat                │
├──────────────┬──────────────────────────┤
│              │                          │
│              │ AI: [AI消息内容...]       │  ← 蓝色边框，左对齐
│              │ ┌────────────────────┐   │
│              │ │ This is a response │   │
│              │ │ from the assistant │   │
│              │ └────────────────────┘   │
│              │                          │
│              │          ┌─────────────┐ │
│              │ You:    │ Your message│ │  ← 绿色边框，右对齐
│              │          └─────────────┘ │
│              │                          │
├──────────────┴──────────────────────────┤
│ [Type your message...]                 │
└─────────────────────────────────────────┘
```

### 3. 组件架构

```
chat.Model (主模型)
  └── Messages: []Message
       └── ChatMessage 子模型
            ├── 样式: 基于角色的边框颜色
            ├── 对齐: 用户右对齐/AI左对齐
            └── 标签: "You:" / "AI:"
```

## Changes Required

### 新增功能
1. 创建 `ChatMessage` 子模型，封装单条消息的渲染逻辑
2. 添加用户消息样式（绿色边框，右对齐，"You:"标签）
3. 添加AI消息样式（蓝色边框，左对齐，"AI:"标签）
4. 实现消息边框样式系统

### 修改内容
1. 更新 `ui/styles.go`：添加消息边框样式定义
2. 更新 `chat/buffer.go`：集成消息渲染逻辑
3. 更新 `internal/app/model.go`：使用新的消息渲染

## Dependencies

- 依赖于现有的 `chat.Message` 类型（包含Role字段）
- 依赖于现有的 `ui.Styles` 系统

## Impact Analysis

### 用户体验影响
- **正面**：清晰的消息区分，提升可读性
- **中性**：需要适应新的视觉布局
- **风险**：低，纯UI改进

### 技术风险
- **低风险**：新功能，不破坏现有代码
- **兼容性**：与现有mode-based styling兼容

## Alternatives Considered

1. **仅使用颜色区分**：对色盲用户不友好，被拒绝
2. **仅使用对齐区分**：视觉强度不够，被拒绝
3. **使用图标代替文本标签**：需要更复杂的渲染，未来可考虑

## Success Criteria

1. ✅ 用户消息显示绿色边框，右对齐，带"You:"标签
2. ✅ AI消息显示蓝色边框，左对齐，带"AI:"标签
3. ✅ 消息边框样式与现有UI风格一致
4. ✅ 多条消息正确堆叠显示
5. ✅ 支持代码块等复杂内容
6. ✅ 响应终端尺寸变化

## Timeline Estimate

- 设计和实现：2-3小时
- 测试和验证：1小时
- 文档更新：30分钟
